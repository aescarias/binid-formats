{
  meta: {
    bdf: "0.2",
    name: "Tagged Image File (TIF/TIFF)",
    exts: [".tiff", ".tif"],
    mime: ["image/tiff", "image/tiff-fx"]
  },
  binary: [
    { id: _tifEndian, type: byte[2], magic: has(["II", "MM"], _) },
    { id: header,
      name: "Header",
      type: struct,
      endian: _tifEndian == "II" ? "little" : "big",
      at: 0,
      fields: [
        { id: byteOrder, type: byte[2], magic: has(["II", "MM"], _), name: "Byte order" },
        { id: version, type: uint16, valid: version == 0x2a, name: "Version" },
        { id: ifdOffset, type: uint32, name: "First IFD at" }
      ]
    },
    { id: imageFileDir,
      name: "Image file directory (IFD) #1",
      type: struct,
      endian: header.byteOrder == "II" ? "little" : "big",
      at: header.ifdOffset,
      fields: [
        { id: tagCount, type: uint16, name: "Number of tags" },
        { id: tags, type: byte[tagCount * 12], name: "Tag data" },
        { id: nextIfd, type: uint32, name: "Next IFD offset" }
      ]
    }
  ]
}