{
  meta: {
    bdf: "0.5",
    name: "Windows Icon",
    mime: ["image/x-icon"],
    exts: [".ico"]
  },
  binary: [
    { id: header,
      type: struct,
      name: "Header",
      endian: "little",
      fields: [
        // the magic includes two reserved bytes plus two bytes for the file type
        // the .ico format structure is also shared with cursor files
        { type: byte[4], magic: _ == "\x00\x00\x01\x00" },
        { type: uint16, id: imageCount, name: "Images" },        
      ]
    },
    { id: entries,
      type: array[header.imageCount],
      name: "Icon Entries",
      item: {
        id: entry,
        type: struct,
        name: "Icon Entry",
        endian: "little",
        fields: [
          { id: width, type: uint8, name: "Width" },
          { id: height, type: uint8, name: "Height" },
          { id: colorCount, type: uint8, name: "Color count" },
          { id: _res, type: uint8, valid: _res == 0 },
          { id: planes, type: uint16, name: "Color planes", valid: planes <= 1 },
          { id: bitCount, type: uint16, name: "Bits per pixel" },
          { id: imageSize, type: uint32, name: "Image size (bytes)" },
          { id: imageOffset, type: uint32, name: "Image offset (bytes)" }
        ]
      }
    }
  ]
}
